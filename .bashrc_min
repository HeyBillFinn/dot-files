set -o vi
export EDITOR=vim

HISTTIMEFORMAT="%F %T "
log_bash_persistent_history()
{
  [[
  $(history 1) =~ ^\ *[0-9]+\ +([^\ ]+\ [^\ ]+)\ +(.*)$
  ]]
  local date_part="${BASH_REMATCH[1]}"
  local command_part="${BASH_REMATCH[2]}"
  if [ "$command_part" != "$PERSISTENT_HISTORY_LAST" ]
  then
    echo $date_part "|" $HOSTNAME "|" "$command_part" >> ~/dot-files/.persistent_history
    export PERSISTENT_HISTORY_LAST="$command_part"
  fi
}

# Stuff to do on PROMPT_COMMAND
run_on_prompt_command()
{
  log_bash_persistent_history
}

PROMPT_COMMAND="run_on_prompt_command"
alias phgrep='cat ~/dot-files/.persistent_history|grep --color'
alias ag='ack-grep'
alias k='fc -s'
alias gchrome='google-chrome --high-dpi-support=1 --force-device-scale-factor=1 > /dev/null 2>&1 &'
bind "set completion-ignore-case on"
bind "set show-all-if-ambiguous on"

alias gpush='git push -u origin HEAD'
alias gmaster='git checkout master && git pull'
